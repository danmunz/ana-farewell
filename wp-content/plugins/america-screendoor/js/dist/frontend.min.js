(function($){"use strict";function sendCertificate(data){$.ajax({method:"post",url:screendoor.ajax_url,dataType:"json",data:{action:"autosend_image",security:screendoor.ajax_nonce,responses:JSON.stringify(data)}}).done(function(msg){console.log(msg)}).fail(function(err){console.log(err)})}function getScreenDoorResponse(ep,email,addLink){var obj={};$.ajax({type:"get",context:this,url:ep,dataType:"json"}).done(function(data){obj.email={};obj.email.address=email,obj.project_id=data[0].project_id;obj.add_link=addLink;obj.responses=data[0].responses;sendCertificate(obj)}).fail(function(err){console.log(err)})}function getEndPoint(id,email){var endpoint="https://screendoor.dobt.co/api/projects/"+id+"/responses?v=0&api_key="+screendoor.sd_api_key+"&direction=desc&advanced_search=";var qry=[{name:"responder_email",method:"is",value:email}];return encodeURI(endpoint+qry)}function hasNoErrors(err){var hasNoErr=err===null||err===undefined?true:false;return hasNoErr}function init(){var frm=$("form[data-formrenderer]"),embedToken=frm.data("sdembedtoken"),projectId=frm.data("sdprojectid"),addLink=frm.data("addlink"),autosend=frm.data("autosend"),email,ep,atts,frmRenderer;if(frm&&projectId){FormRenderer.removePlugin("Autosave");frmRenderer=new FormRenderer({project_id:embedToken});frmRenderer.on("afterValidate:one",function(e){atts=e.attributes;if(atts.field_type=="email"&&!_.isEmpty(atts.value)&&hasNoErrors(atts.error)){email=atts.value}});if(!!autosend){frmRenderer.on("afterSubmit",function(e){if(email){ep=getEndPoint(projectId,email);getScreenDoorResponse(ep,email,addLink)}else{console.log('Missing email, either could not fetch response based on responder email OR email field_tpye is not set to "email" ')}})}}}init()})(jQuery);
//# sourceMappingURL=js/dist/fontend.min.js.map